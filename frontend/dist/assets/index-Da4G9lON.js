(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))r(n);new MutationObserver(n=>{for(const i of n)if(i.type==="childList")for(const c of i.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&r(c)}).observe(document,{childList:!0,subtree:!0});function o(n){const i={};return n.integrity&&(i.integrity=n.integrity),n.referrerPolicy&&(i.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?i.credentials="include":n.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(n){if(n.ep)return;n.ep=!0;const i=o(n);fetch(n.href,i)}})();function E(){const t=document.createElement("div");t.className="flex flex-col items-center justify-center min-h-screen bg-gradient-to-b from-gray-900 to-black text-white text-center p-6";const e=document.createElement("h1");e.className="text-5xl font-bold mb-4",e.innerText="Bienvenue sur Ft Transcendence !";const o=document.createElement("p");o.className="text-lg text-gray-300 mb-6 max-w-2xl",o.innerText="Rejoignez une aventure épique où vous affrontez vos amis dans des tournois de Pong compétitifs ! Inscrivez-vous dès maintenant pour commencer.";const r=document.createElement("div");r.className="flex space-x-4";const n=document.createElement("button");n.className="bg-blue-500 hover:bg-blue-600 text-white font-bold py-2 px-4 rounded",n.innerText="Se Connecter",n.onclick=c=>d(c,"/login");const i=document.createElement("button");return i.className="bg-green-500 hover:bg-green-600 text-white font-bold py-2 px-4 rounded",i.innerText="S'inscrire",i.onclick=c=>d(c,"/register"),r.appendChild(n),r.appendChild(i),t.appendChild(e),t.appendChild(o),t.appendChild(r),t}const a={user:JSON.parse(localStorage.getItem("user")||"null"),token:localStorage.getItem("token")||null};function T(t,e){a.token=t,a.user=e,localStorage.setItem("token",t),localStorage.setItem("user",JSON.stringify(e))}function S(){const t=localStorage.getItem("token"),e=localStorage.getItem("user");t&&e&&(a.token=t,a.user=JSON.parse(e))}function v(){return!!a.token}function C(){a.user=null,a.token=null,localStorage.removeItem("token"),localStorage.removeItem("user"),window.location.href="/login"}async function L(t,e){const o=await fetch("/api/login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:t,password:e})}),r=await o.json();if(!o.ok)throw new Error(r.error||"Erreur de connexion");a.user=r.user,a.token=r.token,localStorage.setItem("token",r.token),localStorage.setItem("user",JSON.stringify(r.user)),window.location.href="/dashboard"}async function P(t,e,o){const r=await fetch("/api/register",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:t,email:e,password:o})}),n=await r.json();if(!r.ok)throw new Error(n.error||"Erreur d'inscription");T(n.token,n.user),window.location.href="/profile"}function O(){const t=document.createElement("nav");t.className="bg-gray-900 p-4 flex justify-between";const e=document.createElement("a");e.innerText="Accueil",e.className="text-white cursor-pointer",e.onclick=()=>d(new Event("click"),"/");const o=document.createElement("div");if(v()){const r=document.createElement("button");r.innerText="Profil",r.className="text-white mx-2",r.onclick=()=>d(new Event("click"),"/profile");const n=document.createElement("button");n.innerText="Déconnexion",n.className="text-red-400 mx-2",n.onclick=C,o.appendChild(r),o.appendChild(n)}else{const r=document.createElement("button");r.innerText="Connexion",r.className="text-white mx-2",r.onclick=()=>d(new Event("click"),"/login");const n=document.createElement("button");n.innerText="S'inscrire",n.className="text-white mx-2",n.onclick=()=>d(new Event("click"),"/register"),o.appendChild(r),o.appendChild(n)}return t.appendChild(e),t.appendChild(o),t}function A(t){const e=document.createElement("div");e.className="min-h-screen flex flex-col bg-gray-900 text-white",e.appendChild(O());const o=document.createElement("div");return o.className="flex flex-col items-center justify-center min-h-screen mt-16 px-4 w-full",o.appendChild(t),e.appendChild(o),e}const x=1e3,h=500,l={x:20,y:h/2-50,width:10,height:100,speed:4},u={x:x-30,y:h/2-50,width:10,height:100,speed:4},s={x:x/2,y:h/2,radius:10,speedX:3,speedY:3,acceleration:1.05};let N=0,k=0;function I(){return{score1:N,score2:k}}function g(t){t===1?N++:t===2&&k++}function y(){s.x=x/2,s.y=h/2,s.speedX=s.speedX>0?-3:3,s.speedY=(Math.random()*2-1)*3}function w(){s.speedX*=s.acceleration,s.speedY*=s.acceleration}function j(t){const e=t.getContext("2d");function o(){if(!e)return;e.clearRect(0,0,t.width,t.height);const{score1:r,score2:n}=I();e.fillStyle="white",e.font="32px Arial",e.fillText(r.toString(),t.width/4,50),e.fillText(n.toString(),t.width*3/4,50),e.fillRect(l.x,l.y,l.width,l.height),e.fillRect(u.x,u.y,u.width,u.height),e.beginPath(),e.arc(s.x,s.y,s.radius,0,Math.PI*2),e.fill(),s.x+=s.speedX,s.y+=s.speedY,(s.y-s.radius<=0||s.y+s.radius>=t.height)&&(s.speedY*=-1),s.x-s.radius<=l.x+l.width&&s.y>=l.y&&s.y<=l.y+l.height&&(s.speedX*=-1,s.x=l.x+l.width+s.radius,w()),s.x+s.radius>=u.x&&s.y>=u.y&&s.y<=u.y+u.height&&(s.speedX*=-1,s.x=u.x-s.radius,w()),s.x+s.radius<=0&&(g(2),y()),s.x-s.radius>=t.width&&(g(1),y()),requestAnimationFrame(o)}o()}const f={};function B(t,e,o){document.addEventListener("keydown",n=>{["ArrowUp","ArrowDown","z","s"].includes(n.key)&&(n.preventDefault(),f[n.key]=!0)}),document.addEventListener("keyup",n=>{["ArrowUp","ArrowDown","z","s"].includes(n.key)&&(f[n.key]=!1)});function r(){f.z&&t.y>0&&(t.y-=t.speed),f.s&&t.y+t.height<o&&(t.y+=t.speed),f.ArrowUp&&e.y>0&&(e.y-=e.speed),f.ArrowDown&&e.y+e.height<o&&(e.y+=e.speed),requestAnimationFrame(r)}r()}function D(){const t=document.createElement("div");t.className="flex flex-col items-center justify-center min-h-screen p-4 text-center";const e=document.createElement("h1");e.className="text-3xl font-bold mb-4",e.innerText="🏓 Mode Pong";const o=document.createElement("canvas");return o.width=1e3,o.height=500,o.className="border-4 border-white",t.appendChild(e),t.appendChild(o),setTimeout(()=>{j(o),B(l,u,o.height)},100),A(t)}async function M(){return await(await fetch("/api/users")).json()}async function J(t,e){return(await fetch("/api/users/update",{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:t,email:e})})).ok}function X(){if(!a.user)return window.location.href="/login",document.createElement("div");const t=document.createElement("div");t.className="flex flex-col items-center p-6 bg-gray-900 text-white rounded-xl shadow-lg w-96 mx-auto mt-20 border border-gray-700";const e=document.createElement("h2");e.innerText="Profil",e.className="text-3xl font-bold mb-4 text-center text-blue-400";const o=document.createElement("img");o.src=a.user.avatar||"default-avatar.png",o.className="w-24 h-24 rounded-full border-2 border-blue-400 mb-3";const r=document.createElement("input");r.type="text",r.value=a.user.username,r.className="input-style";const n=document.createElement("input");n.type="email",n.value=a.user.email,n.className="input-style";const i=document.createElement("button");return i.innerText="Sauvegarder",i.className="btn-primary",i.onclick=async()=>{await J(r.value,n.value)?(a.user.username=r.value,a.user.email=n.value,alert("Profil mis à jour !")):alert("Erreur lors de la mise à jour")},t.append(e,o,r,n,i),t}function b(){const t=document.createElement("form");t.className="flex flex-col items-center p-6 bg-gray-900 text-white rounded-xl shadow-lg w-96 mx-auto mt-20 border border-gray-700";const e=document.createElement("h2");e.innerText="Connexion",e.className="text-3xl font-bold mb-4 text-center text-blue-400";const o=document.createElement("input");o.type="text",o.placeholder="Nom d'utilisateur",o.className="input-style";const r=document.createElement("input");r.type="password",r.placeholder="Mot de passe",r.className="input-style";const n=document.createElement("p");n.className="text-red-500 text-sm mt-2 hidden";const i=document.createElement("button");i.innerText="Se connecter",i.className="btn-primary",i.onclick=async m=>{m.preventDefault(),n.classList.add("hidden");try{await L(o.value,r.value),d(new Event("click"),"/register")}catch(p){n.innerText="Erreur : "+p.message,n.classList.remove("hidden")}};const c=document.createElement("a");return c.innerText="Pas encore inscrit ?",c.className="text-blue-400 hover:underline mt-3 cursor-pointer",c.onclick=m=>{m.preventDefault(),d(new Event("click"),"/register")},t.append(e,o,r,n,i,c),t}function z(){const t=document.createElement("form");t.className="flex flex-col items-center p-6 bg-gray-900 text-white rounded-xl shadow-lg w-96 mx-auto mt-20 border border-gray-700";const e=document.createElement("h2");e.innerText="Inscription",e.className="text-3xl font-bold mb-4 text-center text-blue-400";const o=document.createElement("input");o.type="text",o.placeholder="Nom d'utilisateur",o.className="input-style";const r=document.createElement("input");r.type="email",r.placeholder="Email",r.className="input-style";const n=document.createElement("input");n.type="password",n.placeholder="Mot de passe",n.className="input-style";const i=document.createElement("p");i.className="text-red-500 text-sm mt-2 hidden";const c=document.createElement("button");return c.innerText="S'inscrire",c.className="btn-primary",c.onclick=async m=>{m.preventDefault(),i.classList.add("hidden");try{await P(o.value,r.value,n.value),window.location.href="/login"}catch(p){i.innerText="Erreur : "+p.message,i.classList.remove("hidden")}},t.append(e,o,r,n,i,c),t}function R(){if(!a.user)return window.location.href="/login",document.createElement("div");const t=document.createElement("div");t.className="flex flex-col items-center p-6 bg-gray-900 text-white rounded-xl shadow-lg w-96 mx-auto mt-20 border border-gray-700";const e=document.createElement("h2");e.innerText=`🏠 Bienvenue ${a.user.username}`,e.className="text-3xl font-bold mb-4 text-center text-blue-400";const o=document.createElement("p");o.innerText="📡 Liste des utilisateurs en ligne",o.className="text-lg text-gray-300";const r=document.createElement("ul");r.className="mt-4 text-white";async function n(){const c=await M();r.innerHTML="",c.forEach(m=>{const p=document.createElement("li");p.innerText=`${m.username}`,r.appendChild(p)})}n();const i=document.createElement("button");return i.innerText="👤 Voir mon profil",i.className="btn-primary mt-4",i.onclick=()=>{window.location.href="/profile"},t.append(e,o,r,i),t}const F={"/":E,"/game":D,"/profile":()=>v()?X():b(),"/login":b,"/dashboard":R,"/register":z};function d(t,e){t.preventDefault(),window.history.pushState({},e,window.location.origin+e),window.dispatchEvent(new Event("popstate"))}function U(){const t=document.getElementById("app");if(!t)return;const e=()=>{const o=window.location.pathname,r=F[o]||E;t.innerHTML="",t.appendChild(r())};window.addEventListener("popstate",e),e()}document.addEventListener("DOMContentLoaded",()=>{S(),U()});
